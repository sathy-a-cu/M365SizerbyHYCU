<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HYCU M365 Sizing Report</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 8px 8px 0 0; }
        .header h1 { margin: 0; font-size: 2.5em; }
        .header p { margin: 10px 0 0 0; opacity: 0.9; }
        .content { padding: 30px; }
        .section { margin-bottom: 40px; }
        .section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .metric-card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
        .metric-value { font-size: 2em; font-weight: bold; color: #667eea; }
        .metric-label { color: #666; margin-top: 5px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .table th { background-color: #f8f9fa; font-weight: bold; }
        .recommendation { background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745; margin: 10px 0; }
        .warning { background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin: 10px 0; }
        .footer { text-align: center; padding: 20px; color: #666; border-top: 1px solid #eee; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ HYCU M365 Sizing Report</h1>
            <p>Comprehensive Microsoft 365 Tenant Analysis for Backup Planning</p>
            <p>Generated on: 2025-10-14 17:13:09</p>
        </div>
        
        <div class="content">
            <div class="section">
                <h2>üìä Tenant Overview</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">MSFT</div>
                        <div class="metric-label">Tenant Name</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">95</div>
                        <div class="metric-label">Total Users</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">87</div>
                        <div class="metric-label">Active Users</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">10</div>
                        <div class="metric-label">Guest Users</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üíæ Tenant Capacity</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">59.3 GB</div>
                        <div class="metric-label">Exchange Online</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">0.7 GB per user</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">16.6 GB</div>
                        <div class="metric-label">OneDrive for Business</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">0.2 GB per user</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">75.5 GB</div>
                        <div class="metric-label">SharePoint Online</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">0.9 GB per user</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">151.4 GB</div>
                        <div class="metric-label">Total Storage</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">1.7 GB per user</div>
                    </div>
                </div>
                
                <h3>Initial Cost Estimates</h3>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">$0.03</div>
                        <div class="metric-label">Storage Cost per User</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Monthly</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$0.01</div>
                        <div class="metric-label">Worker Node Cost per User</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Monthly</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$0.04</div>
                        <div class="metric-label">Total Cost per User</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Monthly</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0.15 TB</div>
                        <div class="metric-label">Tenant Size</div>
                        <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Pre-compression</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üìà Growth Projections</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Growth Rate</th>
                            <th>Projected Size (GB)</th>
                            <th>Additional Storage</th>
                        </tr>
                    </thead>
                    <tbody><tr><td>20%</td><td>181.67</td><td>30.28 GB</td></tr><tr><td>10%</td><td>166.53</td><td>15.14 GB</td></tr><tr><td>30%</td><td>196.81</td><td>45.42 GB</td></tr>                    </tbody>
                </table>
            </div>
            
            <div class="section">
                <h2>üë• Teams Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">38</div>
                        <div class="metric-label">Total Teams</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">173</div>
                        <div class="metric-label">Total Channels</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$750</div>
                        <div class="metric-label">Cost per Million Private Messages</div>
                    </div>
                </div>
                <div class="warning">
                    <strong>‚ö†Ô∏è Teams Private Chat Cost Impact:</strong>
                    <p>Protecting Teams private chats (1:1 conversations) incurs additional costs from Microsoft:</p>
                    <ul>
                        <li><strong>Cost per message/notification:</strong> $0.00075</li>
                        <li><strong>Cost per million messages:</strong> $750</li>
                        <li><strong>Impact:</strong> Consider this additional cost when planning Teams private chat protection</li>
                    </ul>
                </div>
            </div>
            
            <div class="section">
                <h2>üìã Planner Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">1</div>
                        <div class="metric-label">Total Plans</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">12</div>
                        <div class="metric-label">Total Tasks</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">12</div>
                        <div class="metric-label">Avg Tasks/Plan</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üìß Mailbox Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">69</div>
                        <div class="metric-label">Total Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">69</div>
                        <div class="metric-label">Active User Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Shared Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Resource Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">17</div>
                        <div class="metric-label">Mailboxes with Archive</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">24.64%</div>
                        <div class="metric-label">Archive Percentage</div>
                    </div>
                </div>
                <div class="recommendation">
                    <strong>üìù Mailbox Type Breakdown:</strong>
                    <p>Total Mailboxes (69) = Active User (69) + Shared (0) + Resource (0)</p>
                    <p>Archive Mailboxes (17) are a feature of existing mailboxes, not separate mailboxes.</p>
                </div>
                
                <div class="warning">
                    <strong>üîç User Count Reconciliation:</strong>
                    <p><strong>Licensed Users:</strong> 25 (for HYCU licensing)</p>
                    <p><strong>Total Mailboxes:</strong> 69 (includes shared, resource, and guest mailboxes)</p>
                    <p><strong>Power Automate Free Users:</strong> 16 (excluded from HYCU licensing)</p>
                    <p><strong>Explanation:</strong> The difference between licensed users and total mailboxes is due to shared mailboxes, resource mailboxes, and guest accounts that don't require HYCU licenses.</p>
                </div>
            </div>
            
            <div class="section">
                <h2>üåê Sites & OneDrive Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">57</div>
                        <div class="metric-label">OneDrive Accounts</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">744</div>
                        <div class="metric-label">SharePoint Sites</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">38</div>
                        <div class="metric-label">Teams Sites</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">782</div>
                        <div class="metric-label">Total Sites</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üë• Groups Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">59</div>
                        <div class="metric-label">Total Groups</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">59</div>
                        <div class="metric-label">Unified Groups</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Security Groups</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Distribution Groups</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üèÜ Top 5 by Size</h2>
                <div class="warning">
                    <strong>üìù Privacy Note:</strong> Microsoft Graph reporting APIs return hashed/encoded names for privacy protection. The names shown are anonymized identifiers, not actual user names.
                    <br><strong>üí° Alternative:</strong> To see actual email addresses, you would need to use Exchange Online PowerShell with appropriate permissions to query mailbox details directly.
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    <div>
                        <h3>üìß Top 5 Mailboxes</h3>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>User (Anonymized)</th>
                                    <th>Size (GB)</th>
                                </tr>
                            </thead>
                            <tbody><tr><td>C1403AC6C3CE2B07EC09382CF6C82159</td><td>0.09</td></tr><tr><td>CB317878500962B662D86200C37E05A8</td><td>0.01</td></tr><tr><td>BCF52298C2CF3B8E3E1F9614C2F45BD6</td><td>0.88</td></tr><tr><td>63D70E6AD020F9C38E2F3A458837F6C7</td><td>0.09</td></tr><tr><td>2EFF149AEDF244FD02D982FBBA964083</td><td>0.79</td></tr>                            </tbody>
                        </table>
                    </div>
                    
                    <div>
                        <h3>üìÅ Top 5 OneDrive Accounts</h3>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>User (Anonymized)</th>
                                    <th>Size (GB)</th>
                                </tr>
                            </thead>
                            <tbody><tr><td>927E927BB991E835D804C82FDC81F53C</td><td>0</td></tr><tr><td>9298E9A0B1F355D1FD3CB607FDD00867</td><td>0.09</td></tr><tr><td>9E357362AB0FDD6E49BEE53ABF1F57A0</td><td>0.67</td></tr><tr><td>559E3EA609B545A204248A19D87CCFE4</td><td>0.59</td></tr><tr><td>D16FB36F0911F878998C136191AF705E</td><td>5.87</td></tr>                            </tbody>
                        </table>
                    </div>
                    
                    <div>
                        <h3>üåê Top 5 SharePoint Sites</h3>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Site (Anonymized)</th>
                                    <th>Size (GB)</th>
                                </tr>
                            </thead>
                            <tbody><tr><td>7A2878369DCC5EC4E1B0C31BCAEAC9E1</td><td>0</td></tr><tr><td>441D559CE77C4A961ADB289A36635DE6</td><td>0.01</td></tr><tr><td>441D559CE77C4A961ADB289A36635DE6</td><td>0.01</td></tr><tr><td>BCF52298C2CF3B8E3E1F9614C2F45BD6</td><td>0.01</td></tr><tr><td>441D559CE77C4A961ADB289A36635DE6</td><td>0.09</td></tr>                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üìã HYCU Licensing Analysis</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">25</div>
                        <div class="metric-label">Total Licensed Users</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">1250 GB</div>
                        <div class="metric-label">HYCU Entitlement (50 GB/user)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">151.39 GB</div>
                        <div class="metric-label">Current Usage</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Additional Licenses Needed</div>
                    </div>
                </div>
                
                <h3>License Distribution by Tier</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>License Type</th>
                            <th>Assigned</th>
                            <th>Consumed</th>
                            <th>Available</th>
                            <th>Storage Limit</th>
                        </tr>
                    </thead>
                    <tbody><tr><td>Unknown License (50 GB)</td><td>25</td><td>25</td><td>0</td><td>50 GB</td></tr>                    </tbody>
                </table>
                
                <h3>Mailbox Analysis</h3>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">69</div>
                        <div class="metric-label">Total Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Shared Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">17</div>
                        <div class="metric-label">Archive Mailboxes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">24.64%</div>
                        <div class="metric-label">Archive Percentage</div>
                    </div>
                </div>
                
                <div class="recommendation">
                    <strong>HYCU Licensing Summary:</strong>
                    <ul>
                        <li>Total Licensed Users: 25</li>
                        <li>HYCU Entitlement: 1250 GB (50 GB per user)</li>
                        <li>Current Usage: 151.39 GB</li>
                        <li>Excess Capacity: 0 GB</li>
                        <li>Additional Licenses Needed: 0</li>
                    </ul>
                </div>
                
                <div class="warning">
                    <strong>Archive Mailbox Analysis:</strong>
                    <ul>
                        <li>Archive Mailboxes: 17 (24.64%)</li>
                        <li>20% Threshold: 14 mailboxes</li>
                        <li>Excess Archive Mailboxes: 3</li>
                        <li>Additional Licenses for Excess Archives: 1</li>
                    </ul>
                </div>
            </div>
            
            <div class="section">
                <h2>üí∞ Initial Cost Estimates</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">$2.18</div>
                        <div class="metric-label">Monthly Storage Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$1.18</div>
                        <div class="metric-label">Monthly Worker Node Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$3.36</div>
                        <div class="metric-label">Total Monthly Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$40.35</div>
                        <div class="metric-label">Total Annual Cost</div>
                    </div>
                </div>
                
                <h3>Storage Cost Breakdown</h3>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">151.39 GB</div>
                        <div class="metric-label">Current Storage</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">90.83 GB</div>
                        <div class="metric-label">After 40% Compression</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">109 GB</div>
                        <div class="metric-label">With 20% Growth</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$26.16</div>
                        <div class="metric-label">Annual Storage Cost</div>
                    </div>
                </div>
                
                <h3>Worker Node Cost Breakdown</h3>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">0.15 TB</div>
                        <div class="metric-label">Tenant Size (Pre-compression)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$8/TB/month</div>
                        <div class="metric-label">Cost per TB per Month</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$1.18</div>
                        <div class="metric-label">Monthly Worker Node Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$14.19</div>
                        <div class="metric-label">Annual Worker Node Cost</div>
                    </div>
                </div>
                
                <div class="recommendation">
                    <strong>Initial Cost Estimates Summary:</strong>
                    <ul>
                        <li><strong>Storage Cost:</strong> $2.18/month ($26.16/year)</li>
                        <li><strong>Worker Node Cost:</strong> $1.18/month ($14.19/year)</li>
                        <li><strong>Total Cost:</strong> $3.36/month ($40.35/year)</li>
                        <li><strong>Assumptions:</strong> 40% compression, 20% growth rate, 0.2% daily change rate, 1-year retention</li>
                    </ul>
                </div>
            </div>
            
        </div>
        
        <div class="footer">
            <p>Generated by HYCU M365 Sizing Tool v1.0 | For backup planning and capacity management</p>
        </div>
    </div>
</body>
</html>
